# 今日の予定確認アプリ 要件定義書

## 1. 目的と背景
- 横浜市在住ユーザーに対して、毎朝確認したい情報（暦・祝日・天気・ゴミ収集・ニュース）を1画面で俯瞰し、タスク計画に役立てる。

## 2. 制約条件
- フロントエンド：`streamlit` で単一ページ構成。
- データ取得：すべて無料で利用可能な API／データ源のみを使用。
- UI：各項目（1〜5）を `st.container` で囲い、見出し＋内容をまとまりで表示。
- 表示文言：APIを利用する項目はコンテナ内に「データ提供：◯◯ API」など明記。ゴミ情報は「API不使用」と表示。
- ユニバーサルデザインに沿ったWebページとし、視認性と操作性に配慮したUIとする。

## 3. データソース一覧
| 項目 | 目的 | エンドポイント / 参照先 |
| --- | --- | --- |
| 今日の日付・曜日 | システム日付を取得して表示 | `datetime.date.today()` |
| 祝日情報 | 当日が祝日か、次の祝日の名称と日付を取得 | `https://holidays-jp.github.io/api/v1/date.json` 等（holidays-jp API） |
| 天気概要 | 今日の天気トピック | `https://www.jma.go.jp/bosai/forecast/data/overview_forecast/140000.json` |
| 詳細天気 | 横浜市の天気、時間別降水確率、最低/最高気温 | `https://www.jma.go.jp/bosai/forecast/data/forecast/140000.json` |
| ゴミ収集 | 今日・明日の収集区分 | 横浜市都筑区長久保地区: `https://www.city.yokohama.lg.jp/kurashi/sumai-kurashi/gomi-recycle/gomi/shushuyobi/tsuzuki/nagyou.html`（静的データ） |
| ニュース | Yahoo!ニュース トップニュース（無料で取得可能なRSS等） | `https://news.yahoo.co.jp/rss/topics/top-picks.xml` など |

## 4. 機能要件（項目別）
### 項目1：今日の日付・曜日
- システム日付から「YYYY年M月D日（曜日）」形式で表示。
- ビジュアル：大きめフォント＋サブテキストで時刻更新タイムスタンプ。

### 項目2：祝日情報
- holidays-jp API から当年の祝日一覧を取得。
- 判定内容
  - 今日が祝日の場合：祝日名を強調表示。
  - 今日が平日の場合：次の祝日の日付と名称を表示。
- コンテナ内に `データ提供：holidays-jp API` を表示。
- APIレスポンスをキャッシュし、1日1回取得で十分。

### 項目3：天気（今日1日）
- 気象庁 API を2本利用。
  - `overview_forecast` でテキスト概要を表示。
  - `forecast` で横浜市（神奈川県東部地域コード）を抽出。
- 必須表示要素
  - 今日の天気（アイコンまたはテキスト）。
  - 今日の時間帯別降水確率（朝/昼/夕/夜など提供範囲に合わせて整形）。
  - 今日の最低気温・最高気温。
  - 天気概要（文章）。
- コンテナ内に `データ提供：気象庁 API` を表記。

### 項目4：ゴミ収集情報
- APIは使わず、曜日→収集区分のマッピングをコードに定義。
- 表示要素
  - 今日の収集区分。
  - 明日の収集区分。
  - リンク「横浜市 都筑区 長久保地区の収集カレンダー」をクリック可能にする。
  - コンテナ内に `API不使用` を明記。
- 収集区分マッピング  
  - 月：なし  
  - 火：燃やすごみ（燃えないごみ・スプレー缶・乾電池）  
  - 水：プラスチック資源  
  - 木：なし  
  - 金：缶・ビン・ペットボトル（小さな金属類）  
  - 土：燃やすごみ（燃えないごみ・スプレー缶・乾電池）  
  - 日：なし

### 項目5：Yahoo!ニュース トップニュース
- 無料で使えるYahoo!ニュースのRSS（トップピック）を利用。
- 取得した最新ニュースを上位数件（例：3〜5件）表示し、タイトル＋リンク形式にする。
- コンテナ内に `データ提供：Yahoo!ニュース` を表記。
- 通信エラー時はリトライしつつ、失敗した場合はエラーメッセージと取得時刻を表示。

## 5. UI/UX要件
- 5つの `st.container` を縦並びにし、各コンテナにタイトル＋本文＋データ出典ラベルを配置。
- 背景はシンプルなライトテーマ、コンテナは角丸＋薄い影で視認性を高める。
- 情報密度が高い項目（天気・ニュース）はカラムや表を用いて整列。
- 自動更新間隔を15分程度に設定するか、手動更新ボタンを設置する。

## 6. 非機能要件
- 無料APIへのアクセス回数は1日数十回以内を目安にキャッシュやセッションステートで制御。
- エラー耐性：API呼び出し失敗時はリトライ→失敗時にユーザー向けメッセージを表示し、アプリ全体が停止しないようにする。
- ログ：開発段階では `streamlit.logger` や標準出力で取得時刻・エラー内容を記録。

## 7. 今後の拡張アイデア（任意）
- 天気アイコンやレーダー画像の表示。
- ゴミ収集の通知機能（メール／Slackなど）。
- 祝日の由来や説明を追加。

上記要件を満たす `要件定義書` を基に、次フェーズで画面設計・実装を進める。
